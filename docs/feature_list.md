# 功能清单 (Feature List)

本项目旨在提供一套完整的年报数据获取与分析解决方案，主要功能模块如下：

## 1. 爬虫模块 (Crawler Module)
**核心脚本**: `1.report_link_crawler.py`

| 功能点           | 描述                                                                             |
| :--------------- | :------------------------------------------------------------------------------- |
| **智能分片查询** | 自动将查询时间跨度按“天”切分，有效突破 API 返回数量限制，确保数据完整性。        |
| **多维度过滤**   | 支持按**年份**、**板块**（深市/沪市/创业板/科创板等）、**行业**进行精确筛选。    |
| **关键词排除**   | 可配置排除关键词列表（如“摘要”、“英文版”、“取消”），过滤无效公告。               |
| **严格年份校验** | 通过正则匹配公告标题中的年份，确保只抓取目标年份的年报，排除历史更正或补充公告。 |
| **断点续传**     | 支持增量保存（每抓取 N 条保存一次 Excel），防止因网络中断导致数据丢失。          |
| **反爬虫策略**   | 内置请求重试机制与随机延时，降低被服务器封禁的风险。                             |

## 2. 转换模块 (Converter Module)
**核心脚本**: `2.pdf_batch_converter.py`

| 功能点         | 描述                                                                                                                   |
| :------------- | :--------------------------------------------------------------------------------------------------------------------- |
| **双模式运行** | **Download 模式**：依据 Excel 链接表自动下载并转换；<br>**Convert-Only 模式**：仅对本地已有的 PDF 文件夹进行批量转换。 |
| **鲁棒下载器** | 自动校验 PDF 文件头（Magic Number）和文件大小，识别并处理伪装成 PDF 的无效文件。                                       |
| **多引擎转换** | 采用自动降级策略：首选 `pdfplumber`，失败后尝试 `PyPDF2`，最后使用 `pdfminer`，最大化转换成功率。                      |
| **并发处理**   | 利用多进程技术（Multiprocessing）并行处理下载与转换任务，大幅提升处理速度。                                            |
| **文件清洗**   | 支持文件名非法字符自动清洗，支持转换后自动删除源 PDF 以节省磁盘空间。                                                  |

## 3. 分析模块 (Analysis Module)
**核心脚本**: `3.text_analysis.py` / `text_analysis_universal.py`

| 功能点         | 描述                                                                        |
| :------------- | :-------------------------------------------------------------------------- |
| **关键词统计** | 基于自定义关键词列表，统计每份年报中的关键词出现频次。                      |
| **总词数统计** | 过滤标点符号与非中文字符，计算年报文本的有效总词数，用于计算词频密度。      |
| **自动化词典** | 运行时自动将配置的关键词加入 `jieba` 分词词典，提高分词准确性。             |
| **结构化输出** | 自动提取文件名中的元数据（股票代码、简称、年份），生成标准化的 Excel 报表。 |
| **通用适配**   | 提供通用版脚本，可对任意结构的 TXT 文件夹进行批量词频分析。                 |

## 4. 深度分析与辅助 (Advanced & Utility)
**核心模块**: `annual_report_mda/`

| 功能点         | 描述                                                                           |
| :------------- | :----------------------------------------------------------------------------- |
| **MD&A 提取**  | 专门针对“管理层讨论与分析”章节的提取算法，支持基于目录页码解析和正则匹配提取。 |
| **质量评分**   | 对提取出的 MD&A 文本进行质量打分，辅助判断提取结果的可靠性。                   |
| **多语言文档** | 提供中文和英文双语文档，方便不同语言背景的用户使用。                           |